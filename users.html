<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Cr√©er un utilisateur et transfert</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
}

form {
    background: white;
    width: 800px;
    margin: 40px auto;
    padding: 20px;
    border-radius: 6px;
}

h3 {
    text-align: center;
    margin-bottom: 20px;
}

.container {
    display: flex;
    gap: 20px;
}

.box {
    flex: 1;
    border: 1px solid #ccc;
    padding: 15px;
    border-radius: 6px;
    background: #fafafa;
}

.box h4 {
    text-align: center;
    margin-bottom: 10px;
}

input, button {
    width: 100%;
    margin-top: 10px;
    padding: 8px;
}

button {
    margin-top: 20px;
    background: #007bff;
    color: white;
    border: none;
    cursor: pointer;
}

p {
    text-align: center;
    margin-top: 10px;
    color: green;
}
</style>
</head>

<body>

<form id="userForm">
    <h3>Cr√©er un transfert</h3>

    <div class="container">

        <!-- üîµ EXP√âDITEUR -->
        <div class="box">
            <h4>Exp√©diteur</h4>

            <input type="email" id="email" placeholder="Email" required />
            <input type="password" id="password" placeholder="Mot de passe" required />

            <input type="number" id="amount" placeholder="Montant envoy√©" required />
            <input type="text" id="senderPhone" placeholder="T√©l√©phone exp√©diteur" required />
            <input type="text" id="originLocation" placeholder="Lieu d'exp√©dition" required />

            <input type="number" id="fees" placeholder="Frais" required />
            <input type="number" id="feePercent" placeholder="% de frais" required />
        </div>

        <!-- üü¢ DESTINATAIRE -->
        <div class="box">
            <h4>Destinataire</h4>

            <input type="text" id="receiverPhone" placeholder="T√©l√©phone destinataire" required />
            <input type="text" id="destinationLocation" placeholder="Lieu de destination" required />

            <input type="number" id="recoveryAmount" placeholder="Montant re√ßu" required />
            <input type="text" id="recoveryMode" placeholder="Mode de r√©cup√©ration" required />
        </div>

    </div>

    <button type="submit">Enregistrer</button>
    <p id="message"></p>
</form>

<script>
// G√©n√®re un code : 1 lettre + 3 chiffres
function generateCode() {
    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const letter = letters[Math.floor(Math.random() * letters.length)];
    const number = Math.floor(100 + Math.random() * 900);
    return letter + number;
}

document.getElementById('userForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const data = {
        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        amount: Number(document.getElementById('amount').value),
        senderPhone: document.getElementById('senderPhone').value,
        receiverPhone: document.getElementById('receiverPhone').value,
        originLocation: document.getElementById('originLocation').value,
        destinationLocation: document.getElementById('destinationLocation').value,
        fees: Number(document.getElementById('fees').value),
        feePercent: Number(document.getElementById('feePercent').value),
        recoveryAmount: Number(document.getElementById('recoveryAmount').value),
        recoveryMode: document.getElementById('recoveryMode').value,
        code: generateCode()
    };

    try {
        const res = await fetch('https://monapi-bf4o.onrender.com/users', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById('message').innerText = result.message;

        if (res.ok) document.getElementById('userForm').reset();
    } catch (err) {
        document.getElementById('message').innerText = 'Erreur serveur';
    }
});
</script>

</body>
</html>
