<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Transfert ‚Äì Exp√©diteur / Destinataire</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f2f2f2;
    }

    form {
        background: white;
        width: 950px;
        margin: 40px auto;
        padding: 20px;
        border-radius: 8px;
    }

    h3 {
        text-align: center;
        margin-bottom: 20px;
    }

    .container {
        display: flex;
        gap: 20px;
    }

    .box {
        flex: 1;
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 6px;
        background: #fafafa;
    }

    .box h4 {
        text-align: center;
        margin-bottom: 15px;
        color: #007bff;
    }

    input, select, button {
        width: 100%;
        margin-top: 10px;
        padding: 8px;
        box-sizing: border-box;
    }

    button {
        margin-top: 20px;
        background: #007bff;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }

    #message {
        text-align: center;
        margin-top: 15px;
        font-weight: bold;
        color: green;
    }
</style>
</head>

<body>

<form id="userForm">
    <h3>Cr√©er un transfert</h3>

    <div class="container">

        <!-- ================= EXP√âDITEUR ================= -->
        <div class="box">
            <h4>üë§ Exp√©diteur</h4>

            <input type="text" id="senderFirstName" placeholder="Pr√©nom exp√©diteur" required />
            <input type="text" id="senderLastName" placeholder="Nom exp√©diteur" required />

            <input type="email" id="email" placeholder="Email exp√©diteur" required />
            <input type="password" id="password" placeholder="Mot de passe" required />

            <input type="number" id="amount" placeholder="Montant envoy√©" required />

            <input type="tel" id="senderPhone" placeholder="T√©l√©phone exp√©diteur" required />

            <select id="originLocation" required>
                <option value="">üåç Pays de d√©part</option>
                <option value="Guin√©e">Guin√©e</option>
                <option value="S√©n√©gal">S√©n√©gal</option>
                <option value="Mali">Mali</option>
                <option value="C√¥te d'Ivoire">C√¥te d'Ivoire</option>
                <option value="France">France</option>
                <option value="Belgique">Belgique</option>
            </select>

            <input type="number" id="fees" placeholder="Frais" required />
            <input type="number" id="feePercent" placeholder="% de frais" required />
        </div>

        <!-- ================= DESTINATAIRE ================= -->
        <div class="box">
            <h4>üë• Destinataire</h4>

            <input type="text" id="receiverFirstName" placeholder="Pr√©nom destinataire" required />
            <input type="text" id="receiverLastName" placeholder="Nom destinataire" required />

            <input type="tel" id="receiverPhone" placeholder="T√©l√©phone destinataire" required />

            <select id="destinationLocation" required>
                <option value="">üåç Pays de destination</option>
                <option value="Guin√©e">Guin√©e</option>
                <option value="S√©n√©gal">S√©n√©gal</option>
                <option value="Mali">Mali</option>
                <option value="C√¥te d'Ivoire">C√¥te d'Ivoire</option>
                <option value="France">France</option>
                <option value="Belgique">Belgique</option>
            </select>

            <input type="number" id="recoveryAmount" placeholder="Montant √† r√©cup√©rer" required />
            <input type="text" id="recoveryMode" placeholder="Mode de r√©cup√©ration" required />
        </div>

    </div>

    <button type="submit">üíæ Enregistrer le transfert</button>
    <p id="message"></p>
</form>

<script>
function generateCode() {
    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const letter = letters[Math.floor(Math.random() * letters.length)];
    const number = Math.floor(100 + Math.random() * 900);
    return letter + number;
}

document.getElementById('userForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const payload = {
        senderFirstName: document.getElementById('senderFirstName').value,
        senderLastName: document.getElementById('senderLastName').value,

        receiverFirstName: document.getElementById('receiverFirstName').value,
        receiverLastName: document.getElementById('receiverLastName').value,

        email: document.getElementById('email').value,
        password: document.getElementById('password').value,
        amount: Number(document.getElementById('amount').value),

        senderPhone: document.getElementById('senderPhone').value,
        receiverPhone: document.getElementById('receiverPhone').value,

        originLocation: document.getElementById('originLocation').value,
        destinationLocation: document.getElementById('destinationLocation').value,

        fees: Number(document.getElementById('fees').value),
        feePercent: Number(document.getElementById('feePercent').value),

        recoveryAmount: Number(document.getElementById('recoveryAmount').value),
        recoveryMode: document.getElementById('recoveryMode').value,

        code: generateCode()
    };

    try {
        const res = await fetch('https://monapi-bf4o.onrender.com/users', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        const data = await res.json();
        document.getElementById('message').innerText = data.message || 'Succ√®s';

        if (res.ok) {
            document.getElementById('userForm').reset();
        }
    } catch (err) {
        console.error(err);
        document.getElementById('message').innerText = 'Erreur serveur';
    }
});
</script>

</body>
</html>
